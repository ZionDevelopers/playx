<!--DON'T add DocType or the player gets fuck*d -->
<html>
    <head>
        <!--Set Background to Black to Avoid "Floating Video" On White-->
        <style type="text/css">
            body {
                margin: 0;
                padding: 0;
                border: 0;
                background: #000000;
                overflow: hidden;
            }

            div#player {
                width: 100%;
                height: 100%;
            }
        </style>

        <title>PlayX Host for Twitch</title>
        <!-- Favicons: START -->
        <link rel="apple-touch-icon" sizes="180x180" href="/playx/img/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/playx/img/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/playx/img/favicon/favicon-16x16.png">
        <link rel="manifest" href="/playx/img/favicon/site.webmanifest">
        <!-- Favicons: END -->

        <!-- Load the Twitch embed script -->
        <script src="https://player.twitch.tv/js/embed/v1.js"></script>
        <script src="/playx/js/common.js"></script>
        <script>
            //Insert Params Into Vars
            var channel = get('channel');
            var videoId = get('videoId');
            var vol = get('vol') ? parseFloat(get('vol')) : 1.0;
            var start = get('start') ? parseFloat(get('start')) : 0.0;
            if (channel != false) {
                var data = {
                    width: "100%",
                    height: "100%",
                    channel: channel
                }
            } else if (videoId != false) {
                var data = {
                    width: "100%",
                    height: "100%",
                    video: videoId
                }
            }	
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-6XKXQZL55B"></script>
        <script src="/playx/js/tracking.js"></script>
    </head>

    <body>
        <div id="player"></div>
        <script>
            var player = new Twitch.Player("player", data);
            player.addEventListener(Twitch.Player.READY, function () {
                player.setVolume(vol);
                if (videoId != false) {                    
                    player.seek(start);                    
                    setInterval(function () {
                        sendPlayerData({ Position: parseInt(player.getCurrentTime()), Duration: parseInt(player.getDuration()) });
                    }, 100);
                }
            });
            
            player.addEventListener(Twitch.Player.PLAY, function () {
                sendPlayerData({ State: 'PLAYING' });
            });
            
            player.addEventListener(Twitch.Player.PAUSE, function () {
                sendPlayerData({ State: 'PAUSED' });
            });
            
            player.addEventListener(Twitch.Player.ENDED, function () {
                sendPlayerData({ State: 'COMPLETED' });
            });            
        </script>
    </body>
</html>